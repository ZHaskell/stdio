<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Std.Data.Vector.Search</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">stdio-0.1.0.0: Standard Input and Output for Haskell</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) Dong Han 2017-2018</td></tr><tr><th>License</th><td>BSD</td></tr><tr><th>Maintainer</th><td>winterland1989@gmail.com</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>non-portable</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Std.Data.Vector.Search</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Element-wise search</a></li><li><a href="#g:2">Sub-vector search</a></li><li><a href="#g:3"><code>Bytes</code> specialized combinators</a></li><li><a href="#g:4">Helpers</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module provides:</p><ul><li>Element-wise searching within vectors</li><li>Fast sub-vector searching algorithm based on KMP string searching.</li><li>A hybrid sub-vector searching algorithm for <code><a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a></code>.</li><li>Rewrite rules to use <code><a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a></code> specialized version if possible.</li></ul></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:findIndices">findIndices</a> :: <a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a =&gt; (a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; v a -&gt; [<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>]</li><li class="src short"><a href="#v:elemIndices">elemIndices</a> :: (<a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a, <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a) =&gt; a -&gt; v a -&gt; [<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>]</li><li class="src short"><a href="#v:find">find</a> :: <a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a =&gt; (a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; v a -&gt; (<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> a)</li><li class="src short"><a href="#v:findR">findR</a> :: <a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a =&gt; (a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; v a -&gt; (<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> a)</li><li class="src short"><a href="#v:findIndex">findIndex</a> :: <a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a =&gt; (a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; v a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li class="src short"><a href="#v:findIndexR">findIndexR</a> :: <a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a =&gt; (a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; v a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li class="src short"><a href="#v:filter">filter</a> :: <span class="keyword">forall</span> v a. <a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a =&gt; (a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; v a -&gt; v a</li><li class="src short"><a href="#v:partition">partition</a> :: <span class="keyword">forall</span> v a. <a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a =&gt; (a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; v a -&gt; (v a, v a)</li><li class="src short"><a href="#v:indicesOverlapping">indicesOverlapping</a> :: (<a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a, <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a) =&gt; v a -&gt; v a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; [<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>]</li><li class="src short"><a href="#v:indices">indices</a> :: (<a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a, <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a) =&gt; v a -&gt; v a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; [<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>]</li><li class="src short"><a href="#v:elemIndicesBytes">elemIndicesBytes</a> :: <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a> -&gt; <a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a> -&gt; [<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>]</li><li class="src short"><a href="#v:findByte">findByte</a> :: <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a> -&gt; <a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a> -&gt; (<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a>)</li><li class="src short"><a href="#v:findByteR">findByteR</a> :: <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a> -&gt; <a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a> -&gt; (<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a>)</li><li class="src short"><a href="#v:indicesOverlappingBytes">indicesOverlappingBytes</a> :: <a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a> -&gt; <a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a> -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; [<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>]</li><li class="src short"><a href="#v:indicesBytes">indicesBytes</a> :: <a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a> -&gt; <a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a> -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; [<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>]</li><li class="src short"><a href="#v:kmpNextTable">kmpNextTable</a> :: (<a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a, <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a) =&gt; v a -&gt; <a href="Std-Data-Array.html#t:PrimArray" title="Std.Data.Array">PrimArray</a> <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li class="src short"><a href="#v:sundayBloom">sundayBloom</a> :: <a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a> -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word64" title="Data.Word">Word64</a></li><li class="src short"><a href="#v:elemSundayBloom">elemSundayBloom</a> :: <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word64" title="Data.Word">Word64</a> -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a> -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Element-wise search</h1></a><div class="top"><p class="src"><a id="v:findIndices" class="def">findIndices</a> :: <a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a =&gt; (a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; v a -&gt; [<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>] <a href="#v:findIndices" class="selflink">#</a></p><div class="doc"><p>The <code><a href="Std-Data-Vector-Search.html#v:findIndex" title="Std.Data.Vector.Search">findIndex</a></code> function takes a predicate and a vector and
 returns the index of the first element in the vector
 satisfying the predicate.</p></div></div><div class="top"><p class="src"><a id="v:elemIndices" class="def">elemIndices</a> :: (<a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a, <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a) =&gt; a -&gt; v a -&gt; [<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>] <a href="#v:elemIndices" class="selflink">#</a></p><div class="doc"><p><em>O(n)</em> The <code><a href="Std-Data-Vector-Search.html#v:elemIndices" title="Std.Data.Vector.Search">elemIndices</a></code> function extends <code><a href="Std-Data-Vector-Base.html#v:elemIndex" title="Std.Data.Vector.Base">elemIndex</a></code>, by returning
 the indices of all elements equal to the query element, in ascending order.</p></div></div><div class="top"><p class="src"><a id="v:find" class="def">find</a> :: <a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a =&gt; (a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; v a -&gt; (<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> a) <a href="#v:find" class="selflink">#</a></p><div class="doc"><p><em>O(n)</em> find the first index and element matching the predicate in a vector
 from left to right, if there isn't one, return (length of the vector, Nothing).</p></div></div><div class="top"><p class="src"><a id="v:findR" class="def">findR</a> :: <a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a =&gt; (a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; v a -&gt; (<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> a) <a href="#v:findR" class="selflink">#</a></p><div class="doc"><p><em>O(n)</em> find the first index and element matching the predicate
 in a vector from right to left, if there isn't one, return '(-1, Nothing)'.</p></div></div><div class="top"><p class="src"><a id="v:findIndex" class="def">findIndex</a> :: <a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a =&gt; (a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; v a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="#v:findIndex" class="selflink">#</a></p><div class="doc"><pre>findIndex f v = fst (find f v)</pre></div></div><div class="top"><p class="src"><a id="v:findIndexR" class="def">findIndexR</a> :: <a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a =&gt; (a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; v a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="#v:findIndexR" class="selflink">#</a></p><div class="doc"><pre>findIndexR f v = fst (findR f v)</pre></div></div><div class="top"><p class="src"><a id="v:filter" class="def">filter</a> :: <span class="keyword">forall</span> v a. <a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a =&gt; (a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; v a -&gt; v a <a href="#v:filter" class="selflink">#</a></p><div class="doc"><p><em>O(n)</em> <code><a href="Std-Data-Vector-Search.html#v:filter" title="Std.Data.Vector.Search">filter</a></code>, applied to a predicate and a vector,
 returns a vector containing those elements that satisfy the
 predicate.</p></div></div><div class="top"><p class="src"><a id="v:partition" class="def">partition</a> :: <span class="keyword">forall</span> v a. <a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a =&gt; (a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; v a -&gt; (v a, v a) <a href="#v:partition" class="selflink">#</a></p><div class="doc"><p><em>O(n)</em> The <code><a href="Std-Data-Vector-Search.html#v:partition" title="Std.Data.Vector.Search">partition</a></code> function takes a predicate, a vector, returns
 a pair of vector with elements which do and do not satisfy the
 predicate, respectively; i.e.,</p><pre>partition p vs == (filter p vs, filter (not . p) vs)</pre></div></div><a href="#g:2" id="g:2"><h1>Sub-vector search</h1></a><div class="top"><p class="src"><a id="v:indicesOverlapping" class="def">indicesOverlapping</a> <a href="#v:indicesOverlapping" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a, <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; v a</td><td class="doc"><p>vector to search for (<code>needle</code>)</p></td></tr><tr><td class="src">-&gt; v a</td><td class="doc"><p>vector to search in (<code>haystack</code>)</p></td></tr><tr><td class="src">-&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></td><td class="doc"><p>report partial match at the end of haystack</p></td></tr><tr><td class="src">-&gt; [<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p><em>O(n+m)</em> Find the offsets of all indices (possibly overlapping) of <code>needle</code>
 within <code>haystack</code> using KMP algorithm.</p><p>The KMP algorithm need pre-calculate a shift table in <em>O(m)</em> time and space,
 the worst case time complexity is <em>O(n+m)</em>. Partial apply this function to
 reuse pre-calculated table between same needles.</p><p>Chunked input are support via partial match argument, if set we will return an
 extra negative index in case of partial match at the end of input chunk, e.g.</p><pre>indicesOverlapping [ascii|ada|]  [ascii|adadad|] True == [0,2,-2]</pre><p>Where <code>-2</code> is the length of the partial match part <code>ad</code> 's negation.</p><p>If an empty pattern is supplied, we will return every possible index of haystack,
 e.g.</p><pre>indicesOverlapping &quot;&quot; &quot;abc&quot; = [0,1,2]</pre><p>References:</p><ul><li>Knuth, Donald; Morris, James H.; Pratt, Vaughan: &quot;Fast pattern matching in strings&quot; (1977)</li><li><a href="http://www-igm.univ-mlv.fr/~lecroq/string/node8.html#SECTION0080">http://www-igm.univ-mlv.fr/~lecroq/string/node8.html#SECTION0080</a></li></ul></div></div><div class="top"><p class="src"><a id="v:indices" class="def">indices</a> :: (<a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a, <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a) =&gt; v a -&gt; v a -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; [<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>] <a href="#v:indices" class="selflink">#</a></p><div class="doc"><p><em>O(n+m)</em> Find the offsets of all non-overlapping indices of <code>needle</code>
 within <code>haystack</code> using KMP algorithm.</p><p>If an empty pattern is supplied, we will return every possible index of haystack,
 e.g.</p><pre>indicesOverlapping &quot;&quot; &quot;abc&quot; = [0,1,2]</pre></div></div><a href="#g:3" id="g:3"><h1><code><a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a></code> specialized combinators</h1></a><div class="top"><p class="src"><a id="v:elemIndicesBytes" class="def">elemIndicesBytes</a> :: <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a> -&gt; <a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a> -&gt; [<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>] <a href="#v:elemIndicesBytes" class="selflink">#</a></p><div class="doc"><p><em>O(n)</em> Special <code><a href="Std-Data-Vector-Search.html#v:elemIndices" title="Std.Data.Vector.Search">elemIndices</a></code> for <code><a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a></code> using <code>memchr(3)</code></p></div></div><div class="top"><p class="src"><a id="v:findByte" class="def">findByte</a> :: <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a> -&gt; <a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a> -&gt; (<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a>) <a href="#v:findByte" class="selflink">#</a></p><div class="doc"><p><em>O(n)</em> Special <code><a href="Std-Data-Vector-Search.html#v:findByte" title="Std.Data.Vector.Search">findByte</a></code> for <code><a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a></code> using <code>memchr(3)</code></p></div></div><div class="top"><p class="src"><a id="v:findByteR" class="def">findByteR</a> :: <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a> -&gt; <a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a> -&gt; (<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a>) <a href="#v:findByteR" class="selflink">#</a></p><div class="doc"><p><em>O(n)</em> Special <code><a href="Std-Data-Vector-Search.html#v:findR" title="Std.Data.Vector.Search">findR</a></code> for <code><a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a></code> with handle roll bit twiddling.</p></div></div><div class="top"><p class="src"><a id="v:indicesOverlappingBytes" class="def">indicesOverlappingBytes</a> <a href="#v:indicesOverlappingBytes" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a></td><td class="doc"><p>bytes to search for (<code>needle</code>)</p></td></tr><tr><td class="src">-&gt; <a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a></td><td class="doc"><p>bytes to search in (<code>haystack</code>)</p></td></tr><tr><td class="src">-&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></td><td class="doc"><p>report partial match at the end of haystack</p></td></tr><tr><td class="src">-&gt; [<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p><em>O(n/m)</em> Find the offsets of all indices (possibly overlapping) of <code>needle</code>
 within <code>haystack</code> using KMP algorithm, combined with simplified sunday's
 rule to obtain <em>O(n/m)</em> complexity in average use case.</p><p>The hybrid algorithm need pre-calculate a shift table in <em>O(m)</em> time and space,
 and a bad character bloom filter in <em>O(m)</em> time and <em>O(1)</em> space, the worst case
 time complexity is <em>O(n+m)</em>.</p><p>References:</p><ul><li>Frantisek FranekChristopher G. JenningsWilliam F. Smyth A Simple Fast Hybrid Pattern-Matching Algorithm (2005)</li><li>D. M. Sunday: A Very Fast Substring Search Algorithm. Communications of the ACM, 33, 8, 132-142 (1990)</li><li>F. Lundh: The Fast Search Algorithm. <a href="http://effbot.org/zone/stringlib.htm">http://effbot.org/zone/stringlib.htm</a> (2006)</li></ul></div></div><div class="top"><p class="src"><a id="v:indicesBytes" class="def">indicesBytes</a> <a href="#v:indicesBytes" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a></td><td class="doc"><p>bytes to search for (<code>needle</code>)</p></td></tr><tr><td class="src">-&gt; <a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a></td><td class="doc"><p>bytes to search in (<code>haystack</code>)</p></td></tr><tr><td class="src">-&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></td><td class="doc"><p>report partial match at the end of haystack</p></td></tr><tr><td class="src">-&gt; [<a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p><em>O(n/m)</em> Find the offsets of all non-overlapping indices of <code>needle</code>
 within <code>haystack</code> using KMP algorithm, combined with simplified sunday's
 rule to obtain <em>O(m/n)</em> complexity in average use case.</p></div></div><a href="#g:4" id="g:4"><h1>Helpers</h1></a><div class="top"><p class="src"><a id="v:kmpNextTable" class="def">kmpNextTable</a> :: (<a href="Std-Data-Vector-Base.html#t:Vec" title="Std.Data.Vector.Base">Vec</a> v a, <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a) =&gt; v a -&gt; <a href="Std-Data-Array.html#t:PrimArray" title="Std.Data.Array">PrimArray</a> <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="#v:kmpNextTable" class="selflink">#</a></p><div class="doc"><p><em>O(m)</em> Calculate the KMP next shift table.</p><p>The shifting rules is: when a mismatch between <code>needle[j]</code> and <code>haystack[i]</code>
 is found, check if <code>next[j] == -1</code>, if so next search continue with <code>needle[0]</code>
 and <code>haystack[i+1]</code>, otherwise continue with <code>needle[next[j]]</code> and <code>haystack[i]</code>.</p></div></div><div class="top"><p class="src"><a id="v:sundayBloom" class="def">sundayBloom</a> :: <a href="Std-Data-Vector-Base.html#t:Bytes" title="Std.Data.Vector.Base">Bytes</a> -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word64" title="Data.Word">Word64</a> <a href="#v:sundayBloom" class="selflink">#</a></p><div class="doc"><p><em>O(m)</em> Calculate a simple bloom filter for simplified sunday's rule.</p><p>The shifting rules is: when a mismatch between <code>needle[j]</code> and <code>haystack[i]</code>
 is found, check if <code>elemSundayBloom bloom haystack[i+n-j]</code>, where n is the
 length of needle, if not then next search can be safely continued with
 <code>haystack[i+n-j+1]</code> and <code>needle[0]</code>, otherwise next searh should continue with
 <code>haystack[i]</code> and <code>needle[0]</code>, or fallback to other shifting rules such as KMP.</p><p>The algorithm is very simple: for a given <code><a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a></code> <code>w</code>, we set the bloom's bit
 at <code>unsafeShiftL 0x01 (w .&amp;. 0x3f)</code>, so there're three false positives per bit.
 This's particularly suitable for search UTF-8 bytes since the significant bits
 of a beginning byte is usually the same.</p></div></div><div class="top"><p class="src"><a id="v:elemSundayBloom" class="def">elemSundayBloom</a> :: <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word64" title="Data.Word">Word64</a> -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a> -&gt; <a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:elemSundayBloom" class="selflink">#</a></p><div class="doc"><p>O(1) Test if a bloom filter contain a certain <code><a href="file:///opt/ghc/8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a></code>.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.20.0</p></div></body></html>